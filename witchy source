--// Load Rayfield UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

--// Create Window
local Window = Rayfield:CreateWindow({
   Name = "Baddies Caribbean | Witches Brew",
   LoadingTitle = "Baddies Caribbean",
   LoadingSubtitle = "by Jace x",
   Theme = "Purple",

   KeySystem = true,
   KeySettings = {
      Title = "Witches Caribbean",
      Subtitle = "discord.gg/yourserver",
      Note = "No Entry For Thee",
      FileName = "WitchesBrew",
      SaveKey = false,
      GrabKeyFromSite = false,
      Key = {"WitchesBrew"}
   }
})

--// Tabs and Sections
local MainTab = Window:CreateTab("Main", nil)
local CastleTab = Window:CreateTab("Castle", nil)

local MainSection = MainTab:CreateSection("Combat")
local CastleSection = CastleTab:CreateSection("Sky Castle")

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

--// Exclusive User Checker
local function isScriptUser(player)
   return player == LocalPlayer
end

--// Castle Setup
local function createFullCastle()
   local castle = Instance.new("Model", workspace)
   castle.Name = "FloatingCastle"

   local platform = Instance.new("Part", castle)
   platform.Size = Vector3.new(140,2,140)
   platform.Anchored = true
   platform.Position = Vector3.new(0,400,0)
   platform.BrickColor = BrickColor.new("Royal purple")
   platform.Material = Enum.Material.SmoothPlastic

   -- Walls
   for _, offset in ipairs({
      Vector3.new(0,10,70), Vector3.new(0,10,-70),
      Vector3.new(70,10,0), Vector3.new(-70,10,0)
   }) do
      local wall = Instance.new("Part", castle)
      wall.Size = Vector3.new(140,22,2)
      wall.Position = platform.Position + offset
      wall.Anchored = true
      wall.BrickColor = BrickColor.new("Really black")
      wall.Material = Enum.Material.Neon
   end

   -- Roof
   local roof = Instance.new("Part", castle)
   roof.Size = Vector3.new(140,2,140)
   roof.Position = platform.Position + Vector3.new(0,22,0)
   roof.Anchored = true
   roof.BrickColor = BrickColor.new("Royal purple")
   roof.Material = Enum.Material.SmoothPlastic

   -- Table
   local table = Instance.new("Part", castle)
   table.Size = Vector3.new(50,2,12)
   table.Position = platform.Position + Vector3.new(0,4,0)
   table.Anchored = true
   table.BrickColor = BrickColor.new("Royal purple")

   -- Floating Crystals
   for i = 1, 8 do
      local crystal = Instance.new("Part", castle)
      crystal.Shape = Enum.PartType.Ball
      crystal.Size = Vector3.new(4,4,4)
      crystal.Position = platform.Position + Vector3.new(math.random(-60,60), math.random(10,30), math.random(-60,60))
      crystal.Anchored = true
      crystal.Material = Enum.Material.Neon
      crystal.BrickColor = BrickColor.new("Bright violet")
   end

   -- Floating Magical Runes
   for i = 1, 5 do
      local rune = Instance.new("Part", castle)
      rune.Size = Vector3.new(6, 0.2, 6)
      rune.Anchored = true
      rune.Position = platform.Position + Vector3.new(math.random(-40, 40), 1, math.random(-40, 40))
      rune.Material = Enum.Material.ForceField
      rune.BrickColor = BrickColor.new("Really black")
   end

   -- Chairs
   for i = -2, 2 do
      if i ~= 0 then
         local chair1 = Instance.new("Seat", castle)
         chair1.Size = Vector3.new(4,2,4)
         chair1.Position = table.Position + Vector3.new(i*10,2,10)
         chair1.Anchored = true
         chair1.BrickColor = BrickColor.new("Really black")

         local chair2 = chair1:Clone()
         chair2.Parent = castle
         chair2.Position = table.Position + Vector3.new(i*10,2,-10)
      end
   end

   -- Mist and Light Effects
   local smoke = Instance.new("ParticleEmitter", platform)
   smoke.Color = ColorSequence.new(Color3.fromRGB(180, 0, 200))
   smoke.Size = NumberSequence.new(8)
   smoke.Rate = 180
   smoke.Lifetime = NumberRange.new(5)
   smoke.Speed = NumberRange.new(1)

   local light = Instance.new("PointLight", platform)
   light.Color = Color3.fromRGB(180, 0, 255)
   light.Brightness = 2
   light.Range = 80

   -- New Castle Rooms
   local function createRoom(pos, name)
      local room = Instance.new("Part", castle)
      room.Name = name
      room.Size = Vector3.new(40,20,40)
      room.Position = pos
      room.Anchored = true
      room.Material = Enum.Material.SmoothPlastic
      room.BrickColor = BrickColor.new("Royal purple")
   end

   createRoom(platform.Position + Vector3.new(80,10,0), "PotionChamber")
   createRoom(platform.Position + Vector3.new(-80,10,0), "RitualSanctum")
   createRoom(platform.Position + Vector3.new(0,10,80), "HallOfWhispers")

   -- Exit Portal
   local exit = Instance.new("Part", castle)
   exit.Size = Vector3.new(8,1,8)
   exit.Anchored = true
   exit.Position = platform.Position + Vector3.new(0,1,65)
   exit.BrickColor = BrickColor.new("Really black")
   exit.Material = Enum.Material.Neon
   exit.Touched:Connect(function(hit)
      local hum = hit.Parent:FindFirstChild("HumanoidRootPart")
      if hum and hit.Parent == LocalPlayer.Character then
         hum.CFrame = CFrame.new(0, 10, 0)
      end
   end)
end

createFullCastle()

--// Castle Teleport
CastleTab:CreateButton({
   Name = "Teleport to Castle",
   Callback = function()
      local char = LocalPlayer.Character
      if char and char:FindFirstChild("HumanoidRootPart") then
         char.HumanoidRootPart.CFrame = CFrame.new(0,405,0)
      end
   end,
})

--// Misty Teleport Keybind (C)
MainTab:CreateKeybind({
   Name = "Misty Teleport",
   CurrentKeybind = "C",
   HoldToInteract = false,
   Callback = function()
      local char = LocalPlayer.Character
      if char and char:FindFirstChild("HumanoidRootPart") then
         char.HumanoidRootPart.CFrame = CFrame.new(0,405,0)
      end
   end,
})


LocalPlayer.Chatted:Connect(function(msg)
   if msg:lower() == "witches!" then
      local origin = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
      if origin then
         for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and isScriptUser(player) and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
               local hrp = player.Character.HumanoidRootPart
               hrp.CFrame = origin.CFrame + Vector3.new(math.random(-5,5), 2, math.random(-5,5))

               -- Summon effects for script users
               local burst = Instance.new("ParticleEmitter", hrp)
               burst.Color = ColorSequence.new(Color3.fromRGB(180, 0, 255))
               burst.Size = NumberSequence.new(4)
               burst.Rate = 200
               burst.Lifetime = NumberRange.new(1.5)
               burst.Speed = NumberRange.new(3)
               burst.EmissionDirection = Enum.NormalId.Top
               game.Debris:AddItem(burst, 2)

               local light = Instance.new("PointLight", hrp)
               light.Color = Color3.fromRGB(180, 0, 255)
               light.Range = 12
               light.Brightness = 2
               game.Debris:AddItem(light, 2)

               local sound = Instance.new("Sound", hrp)
               sound.SoundId = "rbxassetid://9125472915"
               sound.Volume = 1
               sound:Play()
               game.Debris:AddItem(sound, 2)
            end
         end
      end
   end
end)


local Dark MagicSection = Dark MagicTab:CreateSection("Spells")
local Dark MagicSection = Dark MagicTab:CreateSection("Magica")

--// Dark Grab Finish
Dark MagicTab:CreateKeybind({
   Name = "Dark Grab Finish",
   CurrentKeybind = "G",
   HoldToInteract = false,
   Callback = function()
      local target = nil
      for _, player in ipairs(Players:GetPlayers()) do
         if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            target = player
            break
         end
      end

      if target then
         ReplicatedStorage.events.DuoPlrEvents:FireServer("Rush", target.Name)

         local char = LocalPlayer.Character
         if char and char:FindFirstChild("HumanoidRootPart") then
            local effect = Instance.new("ParticleEmitter", char.HumanoidRootPart)
            effect.Color = ColorSequence.new(Color3.fromRGB(255, 0, 255))
            effect.Size = NumberSequence.new(6)
            effect.Rate = 300
            effect.Lifetime = NumberRange.new(1)
            effect.Speed = NumberRange.new(0.5)
            game.Debris:AddItem(effect, 1)
         end

         local sound = Instance.new("Sound", LocalPlayer.Character.HumanoidRootPart)
         sound.SoundId = "rbxassetid://9125472915"
         sound.Volume = 1.2
         sound:Play()

         task.wait(1.2)
         local explosion = Instance.new("Explosion")
         explosion.Position = target.Character.HumanoidRootPart.Position
         explosion.BlastRadius = 15
         explosion.BlastPressure = 100000
         explosion.DestroyJointRadiusPercent = 1
         explosion.Parent = workspace

         target.Character:BreakJoints()
         task.wait(0.5)
         LocalPlayer.Character:BreakJoints()
      end
   end,
})


--// Shadow Cloak (Key: V)
Dark MagicTab:CreateKeybind({
   Name = "Shadow Cloak",
   CurrentKeybind = "V",
   HoldToInteract = false,
   Callback = function()
      local char = LocalPlayer.Character
      if char then
         for _, part in ipairs(char:GetDescendants()) do
            if part:IsA("BasePart") then
               part.Transparency = 0.6
            end
         end
         task.delay(6, function()
            for _, part in ipairs(char:GetDescendants()) do
               if part:IsA("BasePart") then
                  part.Transparency = 0
               end
            end
         end)
      end
   end,
})


--// Curse Mark (Key: X)
Dark MagicTab:CreateKeybind({
   Name = "Curse Mark",
   CurrentKeybind = "X",
   HoldToInteract = false,
   Callback = function()
      for _, player in ipairs(Players:GetPlayers()) do
         if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.WalkSpeed = 6
            task.delay(5, function()
               player.Character.Humanoid.WalkSpeed = 16
            end)
         end
      end
   end,
})


--// Witch’s Roar (Key: Z)
Dark MagicTab:CreateKeybind({
   Name = "Witch’s Roar",
   CurrentKeybind = "Z",
   HoldToInteract = false,
   Callback = function()
      for _, player in ipairs(Players:GetPlayers()) do
         if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid:TakeDamage(15)
         end
      end

      local sound = Instance.new("Sound", LocalPlayer.Character.HumanoidRootPart)
      sound.SoundId = "rbxassetid://9125472915"
      sound.Volume = 2
      sound:Play()
   end,
})
